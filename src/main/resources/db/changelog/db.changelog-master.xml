<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.10.xsd">

  <changeSet id="1.0.0" author="grzybek">
    <createTable tableName="user_details">
      <column name="username" type="VARCHAR(32)">
        <constraints nullable="false" primaryKey="true"/>
      </column>

      <column name="authority" type="VARCHAR(100)">
        <constraints nullable="false"/>
      </column>

      <column name="password" type="VARCHAR(100)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>

  <changeSet id="1.0.1" author="grzybek">
    <insert schemaName="public"
            tableName="user_details">
      <column name="username" value="admin"/>
      <column name="authority" value="ROLE_ADMIN"/>
      <column name="password" value="$2a$10$J1WzqRU/MVlP7TIwrKkmueUdczKhCRnTgAVNYEkm6Do/GCBi97hZq"/>
    </insert>
  </changeSet>

  <changeSet id="1.0.2" author="grzybek">
    <createTable tableName="city">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true"/>
      </column>

      <column name="name" type="VARCHAR(100)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>

  <changeSet id="1.0.3" author="grzybek">
    <createTable tableName="info_category">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true"/>
      </column>

      <column name="name" type="VARCHAR(100)">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>

  <changeSet id="1.0.4" author="grzybek">
    <insert schemaName="public"
            tableName="info_category">
      <column name="id" value="0"/>
      <column name="name" value="Dla wszystkich"/>
    </insert>

    <insert schemaName="public"
            tableName="info_category">
      <column name="id" value="1"/>
      <column name="name" value="Dla drużyn"/>
    </insert>

    <insert schemaName="public"
            tableName="info_category">
      <column name="id" value="2"/>
      <column name="name" value="Podziękowania"/>
    </insert>
  </changeSet>

  <changeSet id="1.0.5" author="grzybek">
    <modifyDataType tableName="info" columnName="info_text" newDataType="text"/>
  </changeSet>

  <changeSet id="1.0.6" author="grzybek">
    <createTable tableName="change">
      <column name="changed_at" type="TIMESTAMP">
        <constraints nullable="false" />
      </column>
    </createTable>
  </changeSet>

  <changeSet id="1.0.7" author="grzybek">
    <sqlFile path="sql/create_change_trigger.sql"
             relativeToChangelogFile="true"
             splitStatements="false"/>
  </changeSet>

  <changeSet id="1.0.8" author="grzybek">
    <sqlFile path="sql/add_change_trigger_to_tables.sql"
             relativeToChangelogFile="true"
             splitStatements="false"/>
  </changeSet>
</databaseChangeLog>
